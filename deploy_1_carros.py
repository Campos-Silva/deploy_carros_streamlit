import streamlit as st

import pandas as pd

from pycaret.classification import load_model, predict_model

from PIL import Image


modelo = load_model('meu-melhor-modelo-para-precos-veiculos')

modelo_custos_seguro = load_model('modelo-para-custos-seguro')

modelo_para_deteccao_de_fumantes = load_model('modelo-para-deteccao-de-fumantes')


paginas = ['Home',  'Precifica√ß√£o de Ve√≠culos Usados', 'Custos de Seguro de Sa√∫de', 'Detec√ß√£o de Fraudadores de Seguro']

pagina = st.sidebar.radio('Navegue por aqui', paginas)


if pagina == "Home":
    st.title('Meus Modelos em Produ√ß√£o')

    st.write('Navegue pelo menu lateral para acessar os meus modelos em produ√ß√£o')


#________________________________



if pagina == "Precifica√ß√£o de Ve√≠culos Usados":
    st.title('Precifica√ß√£o de ve√≠culos usados')

    st.image('https://raw.githubusercontent.com/Campos-Silva/Projeto_1_Precificacao_de_Veiculos_Usados/main/preco_carro_a.png', width=500)

    st.markdown('Constru√≠ esse modelo preditivo para ajudar pessoas, concession√°rias e distribuidoras a obterem uma estimativa de pre√ßos de ve√≠culos baseados em suas caracter√≠sticas.')

    st.markdown('### **Como usar o Modelo?**')

    st.markdown('Configure as caracter√≠sticas do ve√≠culo abaixo com o valor desejado e depois clique em "EXECUTAR MODELO" para gerar o seu pre√ßo previsto.')

    st.markdown('---')

    st.markdown('### **Caracter√≠sticas do ve√≠culo**')


    kilometragem = st.slider('Kilometragem',
                     min_value = 1000,
                     max_value = 195000,
                     value = 65000,
                     step = 500)


    tipo_combustivel = st.selectbox('Combust√≠vel',['Gasolina','Diesel'])


    tipo_do_vendedor = st.selectbox('Tipo do Vendedor',['Individual','Distribuidora', 'Concessionaria'])


    transmissao = st.selectbox('Transmiss√£o',['Manual','Automatico'])


    dono = st.selectbox('Quantidade de Donos',['1¬∫ dono','2¬∫ dono', '3¬∫ dono', '4¬∫ dono e acima'])


    consumo_do_combustivel_kmpl = st.slider('Consumo do combust√≠vel (Km/L)',
                     min_value = 12,
                     max_value = 28,
                     value = 15,
                     step = 1)


    motor_CC = st.slider('Cilindradas do Motor (CC)',
                     min_value = 950,
                     max_value = 1550,
                     value = 1260,
                     step = 50)


    potencia_do_motor_bhp = st.slider('Pot√™ncia do Motor (BHP)',
                     min_value = 48,
                     max_value = 115,
                     value = 80,
                     step = 5)

    Marca = st.selectbox('Marca',['Chevrolet','Datsun','Fiat','Ford','Honda','Hyundai','Mahindra','Maruti','Nissan','Renault','Skoda','Tata','Toyota','Volkswagen'])


    dados0 = {'kilometragem': [kilometragem],
              'tipo_combustivel': [tipo_combustivel],
              'tipo_do_vendedor': [tipo_do_vendedor],
              'transmissao': [transmissao],
              'dono': [dono],
              'consumo_do_combustivel_kmpl': [consumo_do_combustivel_kmpl],
              'motor_CC': [motor_CC],
              'potencia_do_motor_bhp': [consumo_do_combustivel_kmpl],
              'Marca': [Marca]}

    dados = pd.DataFrame(dados0)

    st.markdown('---')

    if st.button('EXECUTAR MODELO'):
        pred = float(predict_model(modelo, data = dados)['Label'].round(2)*6)
        saida = 'O pre√ßo estimado do ve√≠culo √© de R${:.2f}'.format(pred)
        st.subheader(saida)
        st.markdown('')
        st.markdown('Muito obrigado! Espero que tenha gostado üòÑ‚úåÔ∏è')
        st.markdown('Caso deseje mais informa√ß√µes sobre Data Science me siga no [LinkedIn](https://www.linkedin.com/in/lucas-andrei-campos-silva/)')


    st.markdown('---')

    st.markdown('# **Import√¢ncia do modelo**')

    st.markdown('### **√Årea de Neg√≥cios: Venda de ve√≠culos usados**')

    st.image("https://raw.githubusercontent.com/Campos-Silva/Projeto_1_Precificacao_de_Veiculos_Usados/main/comprar_carro_duvida_c.png")

    st.markdown('Quando vamos comprar um **carro usado** uma das primeiras quest√µes que devemos checar √© **se o pre√ßo est√° adequado as caracter√≠sticas do ve√≠culo**. Essa quest√£o deve valer tamb√©m ao vendedor. Ag√™ncias que compram ve√≠culos usados para revender precisam compr√°-los com pre√ßos condizentes as suas caracter√≠sticas, isso para que possam ter lucro nessas revendas. Assim, saber quanto vale um ve√≠culo n√£o √© uma quest√£o trivial, e sim uma quest√£o que influencia nas nossas tomadas de decis√£o (ENGERS; HARTMANN; STERN, 2009; OU et al., 2020).')

    st.markdown('### **Setor em crescimento no Brasil**')

    st.image("https://raw.githubusercontent.com/Campos-Silva/Projeto_1_Precificacao_de_Veiculos_Usados/main/Apresenta%C3%A7%C3%A3o1_b.png")

    st.markdown('Essa quest√£o √© ainda mais importante nos dias de hoje, uma vez que esse setor de neg√≥cios est√° em alta. No Brasil, a venda de carros usados e seminovos tiveram cerca de 8% a mais de vendas acumuladas quando comparadas com o mesmo per√≠odo de 2019, per√≠odo anterior a pandemia (FOLHA, 2021 , FENAUTO, 2021). J√° os primeiros sete meses de 2021 tiveram acr√©scimo de vendas acumuladas de 55%, em compara√ß√£o com o mesmo per√≠odo de 2020 (FOLHA, 2021 ). Esse cen√°rio se deve, principalmente, ao fato de que a pandemia do COVID-19 tem impactado negativamente o fluxo de produ√ß√£o das montadoras, o que ocasionou em 2020 a que queda de 32% de venda de carros novos (El PA√çS, 2021, FENAUTO, 2021).')

    st.markdown('### **Import√¢ncia**')

    st.markdown('Esse modelo permite a tomada de decis√µes visando a maximiza√ß√£o dos lucros e redu√ß√£o de perdas por meio da precifica√ß√£o adequada de ve√≠culos baseados em suas caracter√≠sticas.')

    st.markdown('Para detalhes sobre a sua constru√ß√£o do modelo acesse [*aqui*](https://github.com/Campos-Silva/Projeto_1_Precificacao_de_Veiculos_Usados). No link voc√™ econtrar√° informa√ß√µes sobre o [*conjunto de dados base*](https://www.kaggle.com/nehalbirla/vehicle-dataset-from-cardekho), e as etapas de [*Pr√©-Processamento e Limpeza*](https://github.com/Campos-Silva/Projeto_01_Parte_A_Importacao-e-limpeza-de-dados-no-Python), [*Explora√ß√£o dos Dados*](https://github.com/Campos-Silva/Projeto_01_Parte_B_Exploracao_de_dados_no_Python) e [*Constru√ß√£o do Modelo Preditivo*](https://github.com/Campos-Silva/Projeto_01_Parte_C_Modelos_de_Machine_Learning_no_Python).')

    st.markdown('---')


    col1, col2 = st.columns([0.3, 1])

    with col1:
        st.markdown("### Autor")
        st.markdown("")
        st.markdown("")
        st.markdown("")
        st.image('https://raw.githubusercontent.com/Campos-Silva/Campos-Silva/main/perfil_lucas_andrei_campos_silva.png', width=150)

    with col2:
        st.markdown("")
        st.markdown("")
        st.markdown("")
        st.markdown("#### **Lucas Andrei Campos-Silva**")
        st.markdown("Data Scientist | Business Intelligence (BI) | Analista de Dados | Ph.D. Student")
        st.markdown("")
        st.markdown("Contatos")
        st.markdown("[![linkedin](https://raw.githubusercontent.com/Campos-Silva/deploy_carros_streamlit/main/linkedin_v_35.png)](https://www.linkedin.com/in/lucas-andrei-campos-silva/)")
        st.markdown("[![github](https://raw.githubusercontent.com/Campos-Silva/deploy_carros_streamlit/main/github_v_50.png)](https://github.com/Campos-Silva)")



if pagina == 'Custos de Seguro de Sa√∫de':


    st.title('Modelo para Previs√£o de Custos de Seguro de Sa√∫de')

    st.image('https://raw.githubusercontent.com/Campos-Silva/custos_seguro/main/imagem_2.jpg', width=400)

    st.markdown('Constru√≠ esse modelo preditivo para ajudar Ag√™ncias de Seguro de Sa√∫de a obterem uma estimativa de pre√ßos de seguros de seus clientes baseados em suas caracter√≠sticas.')

    st.markdown('### **Como usar o Modelo?**')

    st.markdown('Insira as informa√ß√µes do cliente com o valor desejado e depois clique em "EXECUTAR MODELO" para gerar o seu pre√ßo previsto.')

    st.markdown('---')

    st.markdown('### **Informa√ß√µes do cliente**')

    Idade = st.slider('Idade',
                     min_value = 18,
                     max_value = 65,
                     value = 30,
                     step = 1)

    Sexo = st.selectbox("Sexo", ['Masculino', 'Feminino'])

    IMC = st.slider('IMC',
                     min_value = 15,
                     max_value = 54,
                     value = 24,
                     step = 1)


    Filhos = st.selectbox("Quantidade de dependentes", [0, 1, 2, 3, 4, 5])

    Fumante = st.selectbox("O cliente √© fumante?", ['Sim', 'Nao'])

    Regiao = st.selectbox("Regi√£o em que reside", 
                                      ['Sudeste', 'Sudoeste', 'Nordeste', 'Noroeste'])


    dados0 = {'Idade': [Idade], 'Sexo': [Sexo], 'IMC': [IMC], 'Filhos': [Filhos], 'Fumante': [Fumante], 'Regiao': [Regiao]}
    dados = pd.DataFrame(dados0)

    st.markdown('---')

    if st.button('EXECUTAR MODELO'):
        pred = float(predict_model(modelo_custos_seguro, data = dados)['Label'].round(2))
        saida = 'O valor do seguro √© de  ${:.2f}'.format(pred)
        st.subheader(saida)
        st.markdown('')
        st.markdown('Muito obrigado! Espero que tenha gostado üòÑ‚úåÔ∏è')
        st.markdown('Caso deseje mais informa√ß√µes sobre Data Science me siga no [LinkedIn](https://www.linkedin.com/in/lucas-andrei-campos-silva/)')

    st.markdown('---')

    st.markdown('# **Import√¢ncia do modelo**')

    st.markdown('### **√Årea de Neg√≥cios: Seguro de Sa√∫de**')

    st.image("https://raw.githubusercontent.com/Campos-Silva/custos_seguro/main/imagem_3.jpg")

    st.markdown('O setor de mercado de seguros tem a miss√£o de proteger seus clientes contra riscos de perdas de seus patrim√¥nios e assegurar prote√ß√£o √† vida e a sa√∫de para as fam√≠lias (CNSEG, 2021).  Como o objeto desse segmento de seguros √© a "sa√∫de", certas caracter√≠sticas do cliente que podem direcionar o seu quadro cl√≠nico e o de seus familiares s√£o levados em considera√ß√£o na precifica√ß√£o do seguro. Isso para que n√£o haja prejudicados durante o acordo de seguro, uma vez que esse setor preza pela boa f√© e a solidariedade, consideradas como base para o mutualismo entre seguradora e cliente (Fenasaude, 2018; CNSEG, 2021).')

    st.markdown('### **Caracter√≠sticas do cliente e o pre√ßo do seguro**')

    st.image("https://raw.githubusercontent.com/Campos-Silva/custos_seguro/main/raio_x.jpg")

    st.markdown('Certas caracter√≠sticas de uma pessoa podem leva-l√° a desenvolver algum tipo de doen√ßa, seja ela fatal ou n√£o. Caracter√≠sticas como h√°bito de fumar, alto √çndice de Massa Corp√≥rea (IMC), e aumento da idade s√£o tr√™s exemplos. √â conhecido que o tabagismo gera no m√≠nimo 50 tipos de enfermidades, como doen√ßas respirat√≥rias e cardiovasculares e c√¢ncer (INCA, 2022). J√° relacionado ao IMC, a obesidade pode acarretar em preju√≠zos a sa√∫de do indiv√≠duo como dificuldades respirat√≥rias e  doen√ßas cardiovasculares (Pinheiro, 2004). Outra caracter√≠stica que pode favorecer a presen√ßa de doen√ßas √© o aumento da idade, favorecendo o surgimento de doen√ßas cr√¥nicas n√£o transmiss√≠veis, como doen√ßas respirat√≥rias, cardiocirculat√≥rias e diabetes (Figueiredo et al., 2021).')

    st.markdown('Especificamente relacionado a essas tr√™s caracter√≠sticas, as seguradoras de sa√∫de tendem dar maior valor do seguro √† pessoas que as possuem. Isso porque elas podem levar uma pessoa a precisar mais do aparato do sistema de sa√∫de do que uma pessoa que n√£o as apresenta.')

    st.markdown('### **Import√¢ncia**')

    st.markdown('Esse modelo permite a tomada de decis√µes visando a maximiza√ß√£o dos lucros e redu√ß√£o de perdas por meio da precifica√ß√£o adequada do custo do seguro para o cliente.')

    st.markdown('---')


    col1, col2 = st.columns([0.3, 1])

    with col1:
        st.markdown("### Autor")
        st.markdown("")
        st.markdown("")
        st.markdown("")
        st.image('https://raw.githubusercontent.com/Campos-Silva/Campos-Silva/main/perfil_lucas_andrei_campos_silva.png', width=150)

    with col2:
        st.markdown("")
        st.markdown("")
        st.markdown("")
        st.markdown("#### **Lucas Andrei Campos-Silva**")
        st.markdown("Data Scientist | Business Intelligence (BI) | Analista de Dados | Ph.D. Student")
        st.markdown("")
        st.markdown("Contatos")
        st.markdown("[![linkedin](https://raw.githubusercontent.com/Campos-Silva/deploy_carros_streamlit/main/linkedin_v_35.png)](https://www.linkedin.com/in/lucas-andrei-campos-silva/)")
        st.markdown("[![github](https://raw.githubusercontent.com/Campos-Silva/deploy_carros_streamlit/main/github_v_50.png)](https://github.com/Campos-Silva)")



if pagina == 'Detec√ß√£o de Fraudadores de Seguro':
    st.title('Modelo para Detec√ß√£o de Fraudadores de Seguro de Sa√∫de')


    st.image('https://raw.githubusercontent.com/Campos-Silva/custos_seguro/main/imagem_fraude.png', width=300)

    st.markdown('Constru√≠ esse modelo preditivo para ajudar Ag√™ncias de Seguro de Sa√∫de a detectarem clientes que estejam possivelmente fraudando informa√ß√µes e assim, obtendo valor de seguro abaixo da tabela de pre√ßos. Isso pode acarretar graves preju√≠zos econ√¥micos a seguradora.')

    st.markdown('A caracter√≠stica a ser detectada √© se o cliente √© de fato fumante ou n√£o.')

    st.markdown('### **Como usar o Modelo?**')

    st.markdown('Insira as informa√ß√µes do cliente com o valor desejado e depois clique em "EXECUTAR MODELO" para detectar se o cliente √© fumante ou n√£o.')

    st.markdown('---')

    st.markdown('### **Informa√ß√µes do cliente**')


    Idade = st.slider('Idade',
                     min_value = 18,
                     max_value = 65,
                     value = 30,
                     step = 1)

    Sexo = st.selectbox('Sexo', ['Masculino', 'Feminino'])
    
    IMC = st.slider('IMC',
                     min_value = 15,
                     max_value = 54,
                     value = 24,
                     step = 1)

    Filhos = st.selectbox("Quantidade de dependentes", [0, 1, 2, 3, 4, 5])
    Custos = st.slider('Custos', 1000, 50000, 10000, 1000)
    Regiao = st.selectbox("Regi√£o em que mora", 
                                      ['Sudeste', 'Sudoeste', 'Nordeste', 'Noroeste'])


    dados0 = {'Idade': [Idade], 'Sexo': [Sexo], 'IMC': [IMC], 'Filhos': [Filhos], 'Custos': [Custos], 'Regiao': [Regiao]}
    dados = pd.DataFrame(dados0)


    dados = pd.DataFrame(dados0)

    st.markdown('---')

    if st.button('EXECUTAR MODELO'):
        pred = predict_model(modelo_para_deteccao_de_fumantes, data = dados)

        resp = 'N√ÉO' if pred['Label'][0] == 'Nao' else 'SIM' 
        
        prob = pred['Score'][0]
        


        st.write('O cliente √© fumante: **{}, com probabilidade de {:.2f}%**'.format(resp, 100*prob))
        st.markdown('')
        st.markdown('Muito obrigado! Espero que tenha gostado üòÑ‚úåÔ∏è')
        st.markdown('Caso deseje mais informa√ß√µes sobre Data Science me siga no [LinkedIn](https://www.linkedin.com/in/lucas-andrei-campos-silva/)')
        


    st.markdown('---')


    st.markdown('# **Import√¢ncia do modelo**')

    st.markdown('### **√Årea de Neg√≥cios: Seguro de Sa√∫de: Detec√ß√£o de Fraudes**')

    st.image("https://raw.githubusercontent.com/Campos-Silva/custos_seguro/main/imagem_5.png")

    st.markdown('Sabendo que certas caracter√≠sticas, como alto √çndice de Massa Corp√≥rea, h√°bito de fumar e aumento da idade, podem elevar o pre√ßo do seguro de sa√∫de, certas pessoas podem usar de m√° f√© e mentir durante o preenchimento de suas informa√ß√µes na hora da assinatura do contrato. Essa a√ß√£o, √© caracterizada como fraude e causa significativas perdas econ√¥micas ao setor de seguros (SQF, 2020). Com o objetivo de monitorar poss√≠veis perdas econ√¥micas em decorr√™ncia de fraudes relacionadas ao setor de mercado de seguros, o Brasil vem monitorando e quantificando o quanto √© perdido. Essas cifras ficam em torno dos milh√µes de reais. Por exemplo, no ano de 2020, foi comprovada a perda de quase 330 milh√µes de reais no primeiro semestre e 391 milhoes de reais no segundo semestre (SQF, 2020). Como √© perdido muito dinheiro devido a fraudes, detect√°-las √© uma quest√£o de alta relev√¢ncia a esse setor de mercado.')

    st.markdown('### **Import√¢ncia**')

    st.markdown('Esse modelo permite a tomada de decis√µes visando a redu√ß√£o de perdas financeiras por meio da detec√ß√£o de poss√≠veis fraudadores do seguro.')

    st.markdown('---')


    col1, col2 = st.columns([0.3, 1])

    with col1:
        st.markdown("### Autor")
        st.markdown("")
        st.markdown("")
        st.markdown("")
        st.image('https://raw.githubusercontent.com/Campos-Silva/Campos-Silva/main/perfil_lucas_andrei_campos_silva.png', width=150)

    with col2:
        st.markdown("")
        st.markdown("")
        st.markdown("")
        st.markdown("#### **Lucas Andrei Campos-Silva**")
        st.markdown("Data Scientist | Business Intelligence (BI) | Analista de Dados | Ph.D. Student")
        st.markdown("")
        st.markdown("Contatos")
        st.markdown("[![linkedin](https://raw.githubusercontent.com/Campos-Silva/deploy_carros_streamlit/main/linkedin_v_35.png)](https://www.linkedin.com/in/lucas-andrei-campos-silva/)")
        st.markdown("[![github](https://raw.githubusercontent.com/Campos-Silva/deploy_carros_streamlit/main/github_v_50.png)](https://github.com/Campos-Silva)")